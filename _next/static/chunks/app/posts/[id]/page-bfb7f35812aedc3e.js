(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[880],{96:(e,t,s)=>{"use strict";s.d(t,{B:()=>d});var a=s(5155),r=s(285),n=s(2115),l=s(9434);function i(e){let{className:t,...s}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,l.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...s})}var o=s(9629);function d(e){let{post:t,comment:s,isEditing:l,setIsEditing:d,onSubmit:c}=e,[u,m]=(0,n.useState)(!1),[p,v]=(0,n.useState)(""),h=(0,n.useRef)(null);(0,n.useEffect)(()=>{s&&v(null==s?void 0:s.body)},[]);let g=async e=>{let{name:a,body:r}=e;try{await c({name:a,body:r,postId:null==t?void 0:t.id})}catch(e){(0,o.o)({type:"error",description:s?"Error updating comment":"Error creating comment"}),m(!1),console.error(e)}finally{(0,o.o)({type:"success",description:"Comment created"}),d(!1),v(""),m(!1)}};return(0,a.jsx)(a.Fragment,{children:l?(0,a.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,a.jsx)(i,{"data-testid":"message-editor",ref:h,className:"bg-transparent outline-none overflow-hidden resize-none !text-base rounded-xl w-full",value:p,onChange:e=>{v(e.target.value)}}),(0,a.jsxs)("div",{className:"flex flex-row gap-2 justify-end",children:[(0,a.jsx)(r.$,{variant:"outline",className:"h-fit py-2 px-3",onClick:()=>{d(!1)},children:"Cancel"}),(0,a.jsx)(r.$,{"data-testid":"message-editor-send-button",variant:"default",className:"h-fit py-2 px-3",disabled:u||!p,onClick:async()=>{m(!0),g({name:"",body:p})},children:u?"Commenting...":"Comment"})]})]}):null})}},2969:(e,t,s)=>{"use strict";s.d(t,{GV:()=>n,jL:()=>r});var a=s(4540);let r=a.wA.withTypes(),n=a.d4.withTypes();a.Pj.withTypes()},4180:(e,t,s)=>{"use strict";s.d(t,{DN:()=>c,FH:()=>n,HI:()=>u,WS:()=>i,z2:()=>d});var a=s(404),r=s(694);let n=(0,a.xP)({reducerPath:"comments",baseQuery:(0,r.cw)({baseUrl:"https://jsonplaceholder.typicode.com/"}),tagTypes:["Comments"],endpoints:e=>({getComments:e.query({query:()=>"comments",providesTags:e=>e?[...e.map(e=>{let{id:t}=e;return{type:"Comments",id:t}}),{type:"Comments",id:"LIST"}]:[{type:"Comments",id:"LIST"}]}),addComment:e.mutation({query:e=>({url:"comments",method:"POST",body:e})}),getComment:e.query({query:e=>"comments/".concat(e),providesTags:(e,t,s)=>[{type:"Comments",id:s}]}),getPostComments:e.query({query:e=>"posts/".concat(e,"/comments"),providesTags:e=>e?[...e.map(e=>{let{id:t}=e;return{type:"Comments",id:t}}),{type:"Comments",id:"LIST"}]:[{type:"Comments",id:"LIST"}]}),updateComment:e.mutation({query:e=>{let{id:t,...s}=e;return{url:"comments/".concat(t),method:"PUT",body:s}}}),deleteComment:e.mutation({query:e=>({url:"comments/".concat(e),method:"DELETE"})})})}),{useGetCommentQuery:l,useGetPostCommentsQuery:i,useGetCommentsQuery:o,useAddCommentMutation:d,useUpdateCommentMutation:c,useDeleteCommentMutation:u}=n},4604:(e,t,s)=>{"use strict";s.d(t,{RJ:()=>a,Re:()=>o,iD:()=>r,uu:()=>i,zc:()=>l});let a=(0,s(5710).Z0)({name:"auth",initialState:{status:void 0,previousUrl:void 0},reducers:{login:e=>{e.status="success"},logout:e=>{e.status=void 0},setPreviousUrl:(e,t)=>{var s;e.previousUrl=null===(s=t.payload.previousUrl)||void 0===s?void 0:s.split("/finera-nextjs")[1]}}}),{login:r,logout:n,setPreviousUrl:l}=a.actions,i=e=>e.auth.status,o=e=>e.auth.previousUrl;a.reducer},5698:(e,t,s)=>{"use strict";s.d(t,{default:()=>j});var a=s(5155),r=s(3262),n=s(285),l=s(4180),i=s(2969),o=s(2115),d=s(9708),c=s(2085),u=s(9434);let m=(0,c.F)("relative block opacity-[0.65]",{variants:{size:{sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"}},defaultVariants:{size:"sm"}}),p=o.forwardRef((e,t)=>{let{className:s,size:r,loading:n=!0,asChild:l=!1,...i}=e,c=l?d.DX:"span",[p,v]=o.useMemo(()=>[(null==s?void 0:s.match(/(?:dark:bg-|bg-)[a-zA-Z0-9-]+/g))||[],null==s?void 0:s.replace(/(?:dark:bg-|bg-)[a-zA-Z0-9-]+/g,"").trim()],[s]);return n?(0,a.jsx)(c,{className:(0,u.cn)(m({size:r,className:v})),ref:t,...i,children:Array.from({length:8}).map((e,t)=>(0,a.jsx)("span",{className:"absolute top-0 left-1/2 w-[12.5%] h-full animate-spinner-leaf-fade",style:{transform:"rotate(".concat(45*t,"deg)"),animationDelay:"".concat(-(100*(7-t)),"ms")},children:(0,a.jsx)("span",{className:(0,u.cn)("block w-full h-[30%] rounded-full",p)})},t))}):null});p.displayName="Spinner";let v=e=>{let{post:t,comment:s}=e;(0,i.jL)();let[r,{isLoading:o}]=(0,l.HI)();return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(n.$,{variant:"ghost",disabled:!0,children:(0,a.jsx)(p,{size:"sm",className:"bg-black dark:bg-white"})})})},h=e=>{let{setIsEditing:t}=e;return(0,a.jsx)(n.$,{variant:"ghost",onClick:()=>{t(!0)},children:(0,a.jsx)(r.vL,{})})};var g=s(96),f=s(4604);let x=e=>{let{comment:t,post:s}=e,r=(0,i.GV)(f.uu),[n,d]=(0,o.useState)(!1),c=(0,i.jL)(),[u,{isLoading:m}]=(0,l.DN)(),p=async e=>{var a;let{body:r}=e,n=await u({...t,body:r}).unwrap();console.log("updatedComment",n),c(l.FH.util.updateQueryData("getPostComments",null!==(a=null==s?void 0:s.id)&&void 0!==a?a:void 0,e=>{let t=e.findIndex(e=>e.id===n.id);-1!==t&&(e[t]={...e[t],...n})}))};return(0,a.jsxs)("li",{className:"grid grid-cols-12 mt-3 mb-7",children:[(0,a.jsxs)("div",{className:"col-span-11",children:[(0,a.jsx)("b",{children:(0,a.jsx)("i",{children:t.email})}),n?(0,a.jsx)(g.B,{post:s,comment:t,isEditing:n,setIsEditing:d,onSubmit:p}):(0,a.jsx)("p",{children:t.body})]}),"success"===r?(0,a.jsxs)("div",{className:"col-span-1",children:[(0,a.jsx)(h,{setIsEditing:d}),(0,a.jsx)(v,{comment:t,post:s})]}):null]})};var y=s(8856);let j=e=>{let{post:t}=e,{data:s=[],isLoading:r}=(0,l.WS)(t.id);return(0,a.jsx)(a.Fragment,{children:r?(0,a.jsxs)("div",{className:"mt-5",children:[(0,a.jsx)("hr",{className:"my-6 border-gray-300"}),[1,2,3].map(e=>(0,a.jsxs)("div",{className:"flex flex-col space-y-3 mt-10",children:[(0,a.jsx)(y.E,{className:"h-4 w-[150px]"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(y.E,{className:"h-4"}),(0,a.jsx)(y.E,{className:"h-4"}),(0,a.jsx)(y.E,{className:"h-4"})]})]},e))]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("hr",{className:"my-6 border-gray-300"}),(0,a.jsx)("ul",{children:s.map(e=>(0,a.jsx)(x,{comment:e,post:t},e.id))})]})})}},5706:(e,t,s)=>{"use strict";s.d(t,{Avatar:()=>y,AvatarFallback:()=>j});var a=s(5155),r=s(2115),n=s(6081),l=s(9033),i=s(2712),o=s(3655),d="Avatar",[c,u]=(0,n.A)(d),[m,p]=c(d),v=r.forwardRef((e,t)=>{let{__scopeAvatar:s,...n}=e,[l,i]=r.useState("idle");return(0,a.jsx)(m,{scope:s,imageLoadingStatus:l,onImageLoadingStatusChange:i,children:(0,a.jsx)(o.sG.span,{...n,ref:t})})});v.displayName=d;var h="AvatarImage";r.forwardRef((e,t)=>{let{__scopeAvatar:s,src:n,onLoadingStatusChange:d=()=>{},...c}=e,u=p(h,s),m=function(e,t){let[s,a]=r.useState("idle");return(0,i.N)(()=>{if(!e){a("error");return}let s=!0,r=new window.Image,n=e=>()=>{s&&a(e)};return a("loading"),r.onload=n("loaded"),r.onerror=n("error"),r.src=e,t&&(r.referrerPolicy=t),()=>{s=!1}},[e,t]),s}(n,c.referrerPolicy),v=(0,l.c)(e=>{d(e),u.onImageLoadingStatusChange(e)});return(0,i.N)(()=>{"idle"!==m&&v(m)},[m,v]),"loaded"===m?(0,a.jsx)(o.sG.img,{...c,ref:t,src:n}):null}).displayName=h;var g="AvatarFallback",f=r.forwardRef((e,t)=>{let{__scopeAvatar:s,delayMs:n,...l}=e,i=p(g,s),[d,c]=r.useState(void 0===n);return r.useEffect(()=>{if(void 0!==n){let e=window.setTimeout(()=>c(!0),n);return()=>window.clearTimeout(e)}},[n]),d&&"loaded"!==i.imageLoadingStatus?(0,a.jsx)(o.sG.span,{...l,ref:t}):null});f.displayName=g;var x=s(9434);function y(e){let{className:t,...s}=e;return(0,a.jsx)(v,{"data-slot":"avatar",className:(0,x.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",t),...s})}function j(e){let{className:t,...s}=e;return(0,a.jsx)(f,{"data-slot":"avatar-fallback",className:(0,x.cn)("bg-muted flex size-full items-center justify-center rounded-full",t),...s})}},6967:(e,t,s)=>{"use strict";s.d(t,{default:()=>u});var a=s(5155),r=s(5695),n=s(285),l=s(2115),i=s(96),o=s(4180),d=s(2969),c=s(4604);let u=e=>{let{post:t}=e,s=(0,r.useRouter)(),[u,m]=(0,l.useState)(!1),[p,v]=(0,l.useState)(!1),h="success"===(0,d.GV)(c.uu),g=(0,d.jL)(),[f,{isLoading:x}]=(0,o.z2)(),y=async e=>{let{name:s,body:a}=e,r=await f({name:s,email:"no-auth@gmail.com",body:a,postId:t.id}).unwrap();g(o.FH.util.updateQueryData("getPostComments",t.id,e=>{e.unshift(r)}))};return(0,a.jsxs)("div",{className:"mt-5",children:[p?null:(0,a.jsx)("div",{children:(0,a.jsx)(n.$,{onClick:()=>{h?(m(h),v(!0)):(s.push("/login"),g((0,c.zc)({previousUrl:new URL(window.location.href).pathname})))},disabled:p,children:"Add comment"})}),u?(0,a.jsx)(i.B,{post:t,isEditing:p,setIsEditing:v,onSubmit:y}):null]})}},8856:(e,t,s)=>{"use strict";s.d(t,{E:()=>n});var a=s(5155),r=s(9434);function n(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"skeleton",className:(0,r.cn)("bg-accent animate-pulse rounded-md",t),...s})}},8938:(e,t,s)=>{Promise.resolve().then(s.bind(s,6967)),Promise.resolve().then(s.bind(s,5698)),Promise.resolve().then(s.bind(s,5706))}},e=>{var t=t=>e(e.s=t);e.O(0,[803,555,753,545,993,441,684,358],()=>t(8938)),_N_E=e.O()}]);