(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[880],{96:(e,t,s)=>{"use strict";s.d(t,{B:()=>d});var a=s(5155),n=s(285),r=s(2115),l=s(9434);function i(e){let{className:t,...s}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,l.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...s})}var o=s(9629);function d(e){let{post:t,comment:s,isEditing:l,setIsEditing:d,onSubmit:u}=e,[c,m]=(0,r.useState)(!1),[p,f]=(0,r.useState)(""),h=(0,r.useRef)(null);(0,r.useEffect)(()=>{s&&f(null==s?void 0:s.body)},[]);let v=async e=>{let{name:a,body:n}=e;try{await u({name:a,body:n,postId:null==t?void 0:t.id})}catch(e){(0,o.o)({type:"error",description:s?"Error updating comment":"Error creating comment"}),m(!1),console.error(e)}finally{(0,o.o)({type:"success",description:"Comment created"}),d(!1),f(""),m(!1)}};return(0,a.jsx)(a.Fragment,{children:l?(0,a.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,a.jsx)(i,{"data-testid":"message-editor",ref:h,className:"bg-transparent outline-none overflow-hidden resize-none !text-base rounded-xl w-full",value:p,onChange:e=>{f(e.target.value)}}),(0,a.jsxs)("div",{className:"flex flex-row gap-2 justify-end",children:[(0,a.jsx)(n.$,{variant:"outline",className:"h-fit py-2 px-3",onClick:()=>{d(!1)},children:"Cancel"}),(0,a.jsx)(n.$,{"data-testid":"message-editor-send-button",variant:"default",className:"h-fit py-2 px-3",disabled:c||!p,onClick:async()=>{m(!0),v({name:"",body:p})},children:c?"Commenting...":"Comment"})]})]}):null})}},1394:(e,t,s)=>{"use strict";s.d(t,{Avatar:()=>l,AvatarFallback:()=>i});var a=s(5155);s(2115);var n=s(5977),r=s(9434);function l(e){let{className:t,...s}=e;return(0,a.jsx)(n.bL,{"data-slot":"avatar",className:(0,r.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",t),...s})}function i(e){let{className:t,...s}=e;return(0,a.jsx)(n.H4,{"data-slot":"avatar-fallback",className:(0,r.cn)("bg-muted flex size-full items-center justify-center rounded-full",t),...s})}},2969:(e,t,s)=>{"use strict";s.d(t,{GV:()=>r,jL:()=>n});var a=s(4540);let n=a.wA.withTypes(),r=a.d4.withTypes();a.Pj.withTypes()},4180:(e,t,s)=>{"use strict";s.d(t,{DN:()=>u,FH:()=>r,HI:()=>c,WS:()=>i,z2:()=>d});var a=s(404),n=s(694);let r=(0,a.xP)({reducerPath:"comments",baseQuery:(0,n.cw)({baseUrl:"https://jsonplaceholder.typicode.com/"}),tagTypes:["Comments"],endpoints:e=>({getComments:e.query({query:()=>"comments",providesTags:e=>e?[...e.map(e=>{let{id:t}=e;return{type:"Comments",id:t}}),{type:"Comments",id:"LIST"}]:[{type:"Comments",id:"LIST"}]}),addComment:e.mutation({query:e=>({url:"comments",method:"POST",body:e})}),getComment:e.query({query:e=>"comments/".concat(e),providesTags:(e,t,s)=>[{type:"Comments",id:s}]}),getPostComments:e.query({query:e=>"posts/".concat(e,"/comments"),providesTags:e=>e?[...e.map(e=>{let{id:t}=e;return{type:"Comments",id:t}}),{type:"Comments",id:"LIST"}]:[{type:"Comments",id:"LIST"}]}),updateComment:e.mutation({query:e=>{let{id:t,...s}=e;return{url:"comments/".concat(t),method:"PUT",body:s}}}),deleteComment:e.mutation({query:e=>({url:"comments/".concat(e),method:"DELETE"})})})}),{useGetCommentQuery:l,useGetPostCommentsQuery:i,useGetCommentsQuery:o,useAddCommentMutation:d,useUpdateCommentMutation:u,useDeleteCommentMutation:c}=r},4604:(e,t,s)=>{"use strict";s.d(t,{RJ:()=>a,Re:()=>o,iD:()=>n,uu:()=>i,zc:()=>l});let a=(0,s(5710).Z0)({name:"auth",initialState:{status:void 0,previousUrl:void 0},reducers:{login:e=>{e.status="success"},logout:e=>{e.status=void 0},setPreviousUrl:(e,t)=>{var s;e.previousUrl=null===(s=t.payload.previousUrl)||void 0===s?void 0:s.split("/finera-nextjs")[1]}}}),{login:n,logout:r,setPreviousUrl:l}=a.actions,i=e=>e.auth.status,o=e=>e.auth.previousUrl;a.reducer},5698:(e,t,s)=>{"use strict";s.d(t,{default:()=>j});var a=s(5155),n=s(3262),r=s(285),l=s(4180),i=s(2969),o=s(2115),d=s(9708),u=s(2085),c=s(9434);let m=(0,u.F)("relative block opacity-[0.65]",{variants:{size:{sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"}},defaultVariants:{size:"sm"}}),p=o.forwardRef((e,t)=>{let{className:s,size:n,loading:r=!0,asChild:l=!1,...i}=e,u=l?d.DX:"span",[p,f]=o.useMemo(()=>[(null==s?void 0:s.match(/(?:dark:bg-|bg-)[a-zA-Z0-9-]+/g))||[],null==s?void 0:s.replace(/(?:dark:bg-|bg-)[a-zA-Z0-9-]+/g,"").trim()],[s]);return r?(0,a.jsx)(u,{className:(0,c.cn)(m({size:n,className:f})),ref:t,...i,children:Array.from({length:8}).map((e,t)=>(0,a.jsx)("span",{className:"absolute top-0 left-1/2 w-[12.5%] h-full animate-spinner-leaf-fade",style:{transform:"rotate(".concat(45*t,"deg)"),animationDelay:"".concat(-(100*(7-t)),"ms")},children:(0,a.jsx)("span",{className:(0,c.cn)("block w-full h-[30%] rounded-full",p)})},t))}):null});p.displayName="Spinner";let f=e=>{let{post:t,comment:s}=e,o=(0,i.jL)(),[d,{isLoading:u}]=(0,l.HI)(),c=async()=>{await d(s.id).unwrap(),o(l.FH.util.updateQueryData("getPostComments",t.id,e=>e.filter(e=>e.id!==s.id)))};return(0,a.jsx)(a.Fragment,{children:u?(0,a.jsx)(r.$,{variant:"ghost",disabled:!0,children:(0,a.jsx)(p,{size:"sm",className:"bg-black dark:bg-white"})}):(0,a.jsx)(r.$,{variant:"ghost",onClick:c,children:(0,a.jsx)(n.uc,{})})})},h=e=>{let{setIsEditing:t}=e;return(0,a.jsx)(r.$,{variant:"ghost",onClick:()=>{t(!0)},children:(0,a.jsx)(n.vL,{})})};var v=s(96),x=s(4604);let g=e=>{let{comment:t,post:s}=e,n=(0,i.GV)(x.uu),[r,d]=(0,o.useState)(!1),u=(0,i.jL)(),[c,{isLoading:m}]=(0,l.DN)(),p=async e=>{var a;let{body:n}=e,r=await c({...t,body:n}).unwrap();console.log("updatedComment",r),u(l.FH.util.updateQueryData("getPostComments",null!==(a=null==s?void 0:s.id)&&void 0!==a?a:void 0,e=>{let t=e.findIndex(e=>e.id===r.id);-1!==t&&(e[t]={...e[t],...r})}))};return(0,a.jsxs)("li",{className:"grid grid-cols-12 mt-3 mb-7",children:[(0,a.jsxs)("div",{className:"col-span-11",children:[(0,a.jsx)("b",{children:(0,a.jsx)("i",{children:t.email})}),r?(0,a.jsx)(v.B,{post:s,comment:t,isEditing:r,setIsEditing:d,onSubmit:p}):(0,a.jsx)("p",{children:t.body})]}),"success"===n?(0,a.jsxs)("div",{className:"col-span-1",children:[(0,a.jsx)(h,{setIsEditing:d}),(0,a.jsx)(f,{comment:t,post:s})]}):null]})};var y=s(8856);let j=e=>{let{post:t}=e,{data:s=[],isLoading:n}=(0,l.WS)(t.id);return(0,a.jsx)(a.Fragment,{children:n?(0,a.jsxs)("div",{className:"mt-5",children:[(0,a.jsx)("hr",{className:"my-6 border-gray-300"}),[1,2,3].map(e=>(0,a.jsxs)("div",{className:"flex flex-col space-y-3 mt-10",children:[(0,a.jsx)(y.E,{className:"h-4 w-[150px]"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(y.E,{className:"h-4"}),(0,a.jsx)(y.E,{className:"h-4"}),(0,a.jsx)(y.E,{className:"h-4"})]})]},e))]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("hr",{className:"my-6 border-gray-300"}),(0,a.jsx)("ul",{children:s.map(e=>(0,a.jsx)(g,{comment:e,post:t},e.id))})]})})}},6654:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return n}});let a=s(2115);function n(e,t){let s=(0,a.useRef)(null),n=(0,a.useRef)(null);return(0,a.useCallback)(a=>{if(null===a){let e=s.current;e&&(s.current=null,e());let t=n.current;t&&(n.current=null,t())}else e&&(s.current=r(e,a)),t&&(n.current=r(t,a))},[e,t])}function r(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let s=e(t);return"function"==typeof s?s:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},6798:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,3063,23)),Promise.resolve().then(s.bind(s,6967)),Promise.resolve().then(s.bind(s,5698)),Promise.resolve().then(s.bind(s,1394))},6967:(e,t,s)=>{"use strict";s.d(t,{default:()=>c});var a=s(5155),n=s(5695),r=s(285),l=s(2115),i=s(96),o=s(4180),d=s(2969),u=s(4604);let c=e=>{let{post:t}=e,s=(0,n.useRouter)(),[c,m]=(0,l.useState)(!1),[p,f]=(0,l.useState)(!1),h="success"===(0,d.GV)(u.uu),v=(0,d.jL)(),[x,{isLoading:g}]=(0,o.z2)(),y=async e=>{let{name:s,body:a}=e,n=await x({name:s,email:"no-auth@gmail.com",body:a,postId:t.id}).unwrap();v(o.FH.util.updateQueryData("getPostComments",t.id,e=>{e.unshift(n)}))};return(0,a.jsxs)("div",{className:"mt-5",children:[p?null:(0,a.jsx)("div",{children:(0,a.jsx)(r.$,{onClick:()=>{h?(m(h),f(!0)):(s.push("/login"),v((0,u.zc)({previousUrl:new URL(window.location.href).pathname})))},disabled:p,children:"Add comment"})}),c?(0,a.jsx)(i.B,{post:t,isEditing:p,setIsEditing:f,onSubmit:y}):null]})}},8856:(e,t,s)=>{"use strict";s.d(t,{E:()=>r});var a=s(5155),n=s(9434);function r(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"skeleton",className:(0,n.cn)("bg-accent animate-pulse rounded-md",t),...s})}}},e=>{var t=t=>e(e.s=t);e.O(0,[803,555,753,545,71,993,441,684,358],()=>t(6798)),_N_E=e.O()}]);